const I18N = {
    nl: {
        skip: "Ga naar hoofdinhoud",
        brand: { name: "Dashboard-in-10-Dagen" },
        header: {
            cta: "Gratis KPI-check",
            nav: "Hoofdnavigatie",
            language: "Taal"
        },
        hero: {
            eyebrow: "Dashboard-in-10-Dagen",
            title: "Van losse Excel naar helder KPI-dashboard.",
            subtitle: "Ik help KMO’s één kernvraag te beantwoorden met een slim, onderhoudsarm dashboard. Vaste prijs. Duidelijke scope. Snel live.",
            primaryCta: "Gratis KPI-check",
            secondaryCta: "Bekijk pakketten"
        },
        availability: "Beschikbaarheid: ik werk enkel in de weekends; planning gebeurt in overleg.",
        badges: { title: "Tools & integraties" },
        audiences: {
            title: "Voor wie?",
            cards: {
                retail: {
                    title: "Retail",
                    copy: "Voor winkelketens die voorraad en marges beter willen volgen."
                },
                horeca: {
                    title: "Horeca",
                    copy: "Voor restaurants of hotels die inzicht willen in omzet en bezetting."
                },
                ecommerce: {
                    title: "E-commerce",
                    copy: "Voor webshops die marketing en fulfilment willen koppelen."
                },
                services: {
                    title: "Diensten",
                    copy: "Voor dienstverleners die facturatie en planning willen stroomlijnen."
                }
            }
        },
        features: {
            title: "Wat krijg je?",
            items: {
                one: "1 kernvraag (sales/voorraad/winstgevendheid)",
                two: "1 live dashboard",
                three: "Koppelingen: CSV, Excel, Google Sheets, Webshop/POS",
                four: "Korte training + video-handleiding"
            }
        },
        packages: {
            title: "Pakketten & prijzen",
            cards: {
                starter: {
                    title: "Starter – €1.200",
                    items: {
                        one: "1 databron • 1 dashboard • 1 revisie • video-handleiding"
                    },
                    cta: "Selecteer Starter"
                },
                pro: {
                    title: "Pro – €2.100",
                    items: {
                        one: "tot 3 databronnen • 2 dashboards • datakwaliteit check • 2 revisies • 1u training"
                    },
                    cta: "Selecteer Pro"
                },
                plus: {
                    title: "Plus – €2.900",
                    items: {
                        one: "tot 5 databronnen • 3 dashboards • KPI-alerts • 30 dagen support • 2u training"
                    },
                    cta: "Selecteer Plus"
                }
            },
            retainer: "Optionele support retainer: €150–€500/maand (updates, kleine wijzigingen, monitoring)."
        },
        results: {
            title: "Resultaat",
            items: {
                one: {
                    metric: "–10% voorraad",
                    copy: "Minder kapitaal vast in stock."
                },
                two: {
                    metric: "+15% marge-inzicht",
                    copy: "Betere product- en kanaalbeslissingen."
                },
                three: {
                    metric: "2u/maand tijdswinst",
                    copy: "Automatische rapportering vervangt handwerk."
                }
            }
        },
        faq: {
            title: "Veelgestelde vragen",
            items: {
                one: {
                    q: "Hoe snel kunnen we starten?",
                    a: "Binnen twee weken na intake plannen we de kick-off, afhankelijk van de datatoegang."
                },
                two: {
                    q: "Welke tools gebruik je?",
                    a: "Ik werk vooral met Power BI, Looker Studio, dbt en Python, afhankelijk van jouw stack."
                },
                three: {
                    q: "Heb ik Power BI-licenties nodig?",
                    a: "Meestal volstaat één Power BI Pro-licentie voor het delen van dashboards."
                },
                four: {
                    q: "Kun je werken met mijn boekhouding/ERP/Shopify?",
                    a: "Ja, via API’s of exports koppel ik systemen zoals Exact, Yuki, Shopify of Teamleader."
                },
                five: {
                    q: "Hoe zit het met AVG en data-veiligheid?",
                    a: "Ik gebruik beveiligde opslag en werk met dataminimalisatie en duidelijke toegangsniveaus."
                },
                six: {
                    q: "Wat is niet in scope?",
                    a: "Langdurige data-engineering projecten of maatwerksoftware vallen buiten deze service."
                }
            }
        },
        about: {
            title: "Over mij",
            bio: "Ik ben Matteo De Moor, Data Engineer (AI). Ik bouw lichte, schaalbare datastromen en dashboards die KMO’s echt gebruiken.",
            links: {
                linkedin: "LinkedIn",
                email: "E-mail Matteo"
            }
        },
        contact: {
            title: "Gratis KPI-check plannen",
            intro: "Laat je gegevens achter en ik neem binnen twee werkdagen contact op.",
            form: {
                name: {
                    label: "Naam",
                    placeholder: "Jouw naam"
                },
                email: {
                    label: "E-mail",
                    placeholder: "naam@bedrijf.be"
                },
                company: {
                    label: "Bedrijf",
                    placeholder: "Bedrijfsnaam"
                },
                message: {
                    label: "Bericht",
                    placeholder: "Waarmee kan ik helpen?"
                },
                consent: "Ik ga akkoord met het verwerken van mijn gegevens volgens de privacyverklaring.",
                submit: "Verstuur",
                reset: "Reset",
                package: {
                    none: "Geen pakket geselecteerd.",
                    selected: (pkg) => `Geselecteerd pakket: ${pkg}`
                },
                success: "Bedankt! Ik neem snel contact op.",
                error: "Oeps, controleer je gegevens en probeer opnieuw."
            }
        },
        footer: {
            privacy: "Privacy",
            terms: "Voorwaarden",
            copyright: "© 2024 Dashboard-in-10-Dagen. Alle rechten voorbehouden."
        },
        seo: {
            title: "Dashboard-in-10-Dagen – KPI dashboards voor KMO's",
            description: "Dashboard-in-10-Dagen helpt KMO's aan een helder KPI-dashboard in 10 dagen. Vaste prijs, duidelijke scope en snelle livegang."
        }
    },
    en: {
        skip: "Skip to main content",
        brand: { name: "Dashboard-in-10-Dagen" },
        header: {
            cta: "Free KPI Check",
            nav: "Primary navigation",
            language: "Language"
        },
        hero: {
            eyebrow: "Dashboard-in-10-Days",
            title: "From scattered spreadsheets to clear KPI dashboards.",
            subtitle: "I help SMEs answer one core business question with a lean, low-maintenance dashboard. Fixed price. Clear scope. Fast to value.",
            primaryCta: "Free KPI Check",
            secondaryCta: "View Packages"
        },
        availability: "Availability: I’m available on weekends only; planning is by mutual agreement.",
        badges: { title: "Tools & integrations" },
        audiences: {
            title: "Who is it for?",
            cards: {
                retail: {
                    title: "Retail",
                    copy: "For store chains wanting tighter grip on inventory and margins."
                },
                horeca: {
                    title: "Hospitality",
                    copy: "For restaurants or hotels seeking clarity on revenue and occupancy."
                },
                ecommerce: {
                    title: "E-commerce",
                    copy: "For online shops linking marketing and fulfillment insights."
                },
                services: {
                    title: "Services",
                    copy: "For agencies and consultants streamlining billing and scheduling."
                }
            }
        },
        features: {
            title: "What you get",
            items: {
                one: "One core question (sales/inventory/profitability)",
                two: "1 live dashboard",
                three: "Connectors: CSV, Excel, Google Sheets, Webshop/POS",
                four: "Short training + video guide"
            }
        },
        packages: {
            title: "Packages & pricing",
            cards: {
                starter: {
                    title: "Starter – €1,200",
                    items: {
                        one: "1 data source • 1 dashboard • 1 revision • video guide"
                    },
                    cta: "Choose Starter"
                },
                pro: {
                    title: "Pro – €2,100",
                    items: {
                        one: "up to 3 data sources • 2 dashboards • data quality check • 2 revisions • 1h training"
                    },
                    cta: "Choose Pro"
                },
                plus: {
                    title: "Plus – €2,900",
                    items: {
                        one: "up to 5 data sources • 3 dashboards • KPI alerts • 30 days support • 2h training"
                    },
                    cta: "Choose Plus"
                }
            },
            retainer: "Optional support retainer: €150–€500/month (updates, minor changes, monitoring)."
        },
        results: {
            title: "Outcomes",
            items: {
                one: {
                    metric: "–10% inventory",
                    copy: "Less capital locked in stock."
                },
                two: {
                    metric: "+15% margin insight",
                    copy: "Sharper product and channel decisions."
                },
                three: {
                    metric: "2h/month time saved",
                    copy: "Automated reporting replaces manual work."
                }
            }
        },
        faq: {
            title: "FAQ",
            items: {
                one: {
                    q: "How fast can we start?",
                    a: "We can kick off within two weeks after intake, depending on data access."
                },
                two: {
                    q: "Which tools do you use?",
                    a: "Mainly Power BI, Looker Studio, dbt, and Python, aligned with your stack."
                },
                three: {
                    q: "Do I need Power BI licenses?",
                    a: "Usually one Power BI Pro license is enough for sharing dashboards."
                },
                four: {
                    q: "Can you work with my accounting/ERP/Shopify?",
                    a: "Yes, via APIs or exports I connect systems like Exact, Yuki, Shopify, or Teamleader."
                },
                five: {
                    q: "How about GDPR and data security?",
                    a: "I use secure storage, data minimization, and clear access levels."
                },
                six: {
                    q: "What’s out of scope?",
                    a: "Long-term data engineering or custom software projects are outside this service."
                }
            }
        },
        about: {
            title: "About me",
            bio: "I’m Matteo De Moor, a Data Engineer (AI). I build lean, scalable data pipelines and dashboards that SMEs actually use.",
            links: {
                linkedin: "LinkedIn",
                email: "Email Matteo"
            }
        },
        contact: {
            title: "Book a free KPI check",
            intro: "Leave your details and I’ll get back within two business days.",
            form: {
                name: {
                    label: "Name",
                    placeholder: "Your name"
                },
                email: {
                    label: "Email",
                    placeholder: "name@company.com"
                },
                company: {
                    label: "Company",
                    placeholder: "Company name"
                },
                message: {
                    label: "Message",
                    placeholder: "How can I help?"
                },
                consent: "I agree to the processing of my data according to the privacy policy.",
                submit: "Send",
                reset: "Reset",
                package: {
                    none: "No package selected.",
                    selected: (pkg) => `Selected package: ${pkg}`
                },
                success: "Thanks! I’ll be in touch soon.",
                error: "Oops, check your details and try again."
            }
        },
        footer: {
            privacy: "Privacy",
            terms: "Terms",
            copyright: "© 2024 Dashboard-in-10-Days. All rights reserved."
        },
        seo: {
            title: "Dashboard-in-10-Days – KPI dashboards for SMEs",
            description: "Dashboard-in-10-Days delivers a clear KPI dashboard fast. Fixed price, clear scope, and a lean setup for SMEs."
        }
    }
};

const STORAGE_KEYS = {
    language: "dashboard10dagen-language"
};

const packageLabels = {
    nl: {
        Starter: "Starter – €1.200",
        Pro: "Pro – €2.100",
        Plus: "Plus – €2.900"
    },
    en: {
        Starter: "Starter – €1,200",
        Pro: "Pro – €2,100",
        Plus: "Plus – €2,900"
    }
};

const metaDescription = document.getElementById("meta-description");
const ogTitle = document.getElementById("og-title");
const ogDescription = document.getElementById("og-description");

function translate(lang) {
    const dict = I18N[lang];
    if (!dict) return;

    document.documentElement.lang = lang;
    document.title = dict.seo.title;
    metaDescription.setAttribute("content", dict.seo.description);
    ogTitle.setAttribute("content", dict.seo.title);
    ogDescription.setAttribute("content", dict.seo.description);

    document.querySelectorAll("[data-i18n]").forEach((el) => {
        const keys = el.dataset.i18n.split(".");
        let value = dict;
        for (const key of keys) {
            value = value?.[key];
        }
        if (typeof value === "function") {
            return;
        }
        if (typeof value === "string") {
            el.innerHTML = value;
        }
    });

    document.querySelectorAll("[data-i18n-placeholder]").forEach((el) => {
        const keys = el.dataset.i18nPlaceholder.split(".");
        let value = dict;
        for (const key of keys) {
            value = value?.[key];
        }
        if (typeof value === "string") {
            el.placeholder = value;
        }
    });

    document.querySelectorAll("[data-i18n-aria-label]").forEach((el) => {
        const keys = el.dataset.i18nAriaLabel.split(".");
        let value = dict;
        for (const key of keys) {
            value = value?.[key];
        }
        if (typeof value === "string") {
            el.setAttribute("aria-label", value);
        }
    });

    const contactPackage = document.getElementById("package-selected");
    const hiddenPackage = document.getElementById("selectedPackage");
    if (hiddenPackage.value) {
        const labelFn = dict.contact.form.package.selected;
        contactPackage.textContent = typeof labelFn === "function" ? labelFn(packageLabels[lang][hiddenPackage.value]) : hiddenPackage.value;
    } else {
        const noneText = dict.contact.form.package.none;
        if (typeof noneText === "string") {
            contactPackage.textContent = noneText;
        }
    }

    document.querySelectorAll(".select-package").forEach((btn) => {
        btn.setAttribute("aria-label", btn.textContent.trim());
    });

    localStorage.setItem(STORAGE_KEYS.language, lang);
    updateLangButtons(lang);
}

function updateLangButtons(activeLang) {
    document.querySelectorAll(".lang-button").forEach((btn) => {
        const isActive = btn.dataset.lang === activeLang;
        btn.setAttribute("aria-pressed", String(isActive));
    });
}

function setupLanguageToggle() {
    const stored = localStorage.getItem(STORAGE_KEYS.language);
    const defaultLang = stored && I18N[stored] ? stored : "nl";
    translate(defaultLang);

    document.querySelectorAll(".lang-button").forEach((btn) => {
        btn.addEventListener("click", () => {
            const lang = btn.dataset.lang;
            translate(lang);
        });
    });
}

function setupSmoothScroll() {
    const ctaLinks = document.querySelectorAll("[data-scroll]");
    ctaLinks.forEach((link) => {
        link.addEventListener("click", (event) => {
            const href = link.getAttribute("href");
            if (href && href.startsWith("#")) {
                event.preventDefault();
                const target = document.querySelector(href);
                if (target) {
                    target.scrollIntoView({ behavior: "smooth" });
                }
            }
        });
    });
}

function setupPackageSelection() {
    const buttons = document.querySelectorAll(".select-package, [data-package]");
    const hiddenPackage = document.getElementById("selectedPackage");
    const packageSelected = document.getElementById("package-selected");

    buttons.forEach((btn) => {
        btn.addEventListener("click", () => {
            const pkg = btn.dataset.package;
            if (!pkg) return;
            hiddenPackage.value = pkg;
            const lang = document.documentElement.lang;
            const dict = I18N[lang];
            const labelFn = dict.contact.form.package.selected;
            packageSelected.textContent = typeof labelFn === "function" ? labelFn(packageLabels[lang][pkg]) : pkg;
        });
    });
}

function setupForm() {
    const form = document.querySelector(".contact-form");
    const feedback = form.querySelector(".form-feedback");

    form.addEventListener("submit", (event) => {
        event.preventDefault();
        if (!form.checkValidity()) {
            form.reportValidity();
            const lang = document.documentElement.lang;
            feedback.textContent = I18N[lang].contact.form.error;
            feedback.classList.remove("success");
            feedback.classList.add("error");
            return;
        }
        const submitBtn = form.querySelector('button[type="submit"]');
        submitBtn.disabled = true;
        submitBtn.classList.add("is-loading");
        feedback.textContent = "";

        setTimeout(() => {
            const lang = document.documentElement.lang;
            feedback.textContent = I18N[lang].contact.form.success;
            feedback.classList.add("success");
            feedback.classList.remove("error");
            submitBtn.disabled = false;
            submitBtn.classList.remove("is-loading");
            form.reset();
            document.getElementById("selectedPackage").value = "";
            feedback.focus?.();
            translate(lang);
        }, 800);
    });

    form.addEventListener("reset", () => {
        const lang = document.documentElement.lang;
        document.getElementById("selectedPackage").value = "";
        feedback.textContent = "";
        feedback.classList.remove("success", "error");
        document.getElementById("package-selected").textContent = I18N[lang].contact.form.package.none;
    });
}

function setupObserver() {
    const observer = new IntersectionObserver((entries) => {
        entries.forEach((entry) => {
            if (entry.isIntersecting) {
                entry.target.classList.add("is-visible");
                observer.unobserve(entry.target);
            }
        });
    }, { threshold: 0.15 });

    document.querySelectorAll("[data-observe]").forEach((el) => observer.observe(el));
}

window.addEventListener("DOMContentLoaded", () => {
    setupLanguageToggle();
    setupSmoothScroll();
    setupPackageSelection();
    setupForm();
    setupObserver();
});
